(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;
    for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);
    new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const n of t.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&a(n)}).observe(document,{childList:!0,subtree:!0});function i(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function a(e){if(e.ep)return;e.ep=!0;const t=i(e);fetch(e.href,t)}})();const m={apiKey:"AIzaSyAMimu-AKBo-ISvXCS4wORyCfyHVwFi8D0",authDomain:"labln-fd4bb.firebaseapp.com",databaseURL:"https://labln-fd4bb-default-rtdb.firebaseio.com",projectId:"labln-fd4bb",storageBucket:"labln-fd4bb.appspot.com",messagingSenderId:"181646000819",appId:"1:181646000819:web:d97cbfb2a1b4e3dac066c6",measurementId:"G-V2ZG8EX96K"};firebase.initializeApp(m);const d=firebase.database(),c=document.querySelector(".toggle-password"),f=document.getElementById("password");c.addEventListener("click",()=>{const o=f.getAttribute("type")==="password"?"text":"password";f.setAttribute("type",o),c.textContent=o==="password"?"👁️":"🙈"});document.getElementById("loginForm").addEventListener("submit",o=>{o.preventDefault();const s=document.getElementById("email").value.trim(),i=document.getElementById("password").value;if(!s||!i){alert("Vui lòng nhập đầy đủ email và mật khẩu.");return}d.ref("users").orderByChild("email").equalTo(s).once("value").then(e=>{if(!e.exists()){alert("Tài khoản không tồn tại trong hệ thống.");return}let t=!1;e.forEach(n=>{const r=n.val(),l=n.key;if(r.password===i){if(t=!0,r.status!=="active"){alert("Tài khoản của bạn không hoạt động. Vui lòng liên hệ quản trị viên.");return}if(r.role!=="admin"){alert("Tài khoản không có quyền truy cập trang admin");return}const u=new Date("2025-05-28T09:18:00+07:00").toISOString();d.ref(`users/${l}/lastLogin`).set(u),sessionStorage.setItem("currentUser",JSON.stringify({id:l,email:r.email,fullName:r.fullName,role:r.role,status:r.status,lastLogin:u})),window.location.href="./assest/dashboard/dashboard.html"}}),t||alert("Mật khẩu không chính xác.")}).catch(e=>{console.error("Lỗi khi đăng nhập:",e),alert("Đã xảy ra lỗi khi đăng nhập. Vui lòng thử lại.")})});
